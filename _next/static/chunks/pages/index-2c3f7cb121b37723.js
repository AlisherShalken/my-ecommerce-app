(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(6732)}])},6732:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var s=r(5893),n=r(9008),l=r.n(n),a=r(7294),i=e=>{let{product:t,onAddToCart:r}=e;return(0,s.jsxs)("div",{className:"border border-red-500 p-4 rounded-lg bg-white hover:shadow-lg transition-shadow duration-300",children:[(0,s.jsx)("img",{src:t.image,alt:t.name,className:"w-full h-48 object-cover mb-2 rounded"}),(0,s.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:t.name}),(0,s.jsxs)("p",{className:"text-xl text-gray-700 font-semibold",children:[t.price," ₸"]}),(0,s.jsx)("button",{className:"mt-4 p-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors duration-200",onClick:()=>r(t),children:"В корзину"})]})},o=e=>{let{onAddToCart:t}=e,[r,n]=(0,a.useState)([]),[l,o]=(0,a.useState)([]),[c,d]=(0,a.useState)("Все"),[u,h]=(0,a.useState)("asc"),[x,m]=(0,a.useState)(""),[g,f]=(0,a.useState)(1);(0,a.useEffect)(()=>{fetch("http://localhost:3001/products").then(e=>e.json()).then(e=>{n(e),o(e)}).catch(e=>console.error("Ошибка при загрузке данных:",e))},[]);let p=e=>{d(e),f(1)};(0,a.useEffect)(()=>{let e=r;"Все"!==c&&(e=e.filter(e=>e.category===c)),x&&(e=e.filter(e=>e.name.toLowerCase().includes(x.toLowerCase()))),o([...e].sort((e,t)=>"asc"===u?e.price-t.price:t.price-e.price))},[r,c,u,x]);let b=10*g-10,j=l.slice(b,b+10),v=e=>f(e);return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between mb-4 space-y-2 sm:space-y-0",children:[(0,s.jsx)("input",{type:"text",placeholder:"Поиск товаров...",className:"p-2 border rounded w-full sm:w-auto flex-grow mr-0 sm:mr-4",value:x,onChange:e=>m(e.target.value)}),(0,s.jsxs)("select",{className:"p-2 border rounded w-full sm:w-auto",value:u,onChange:e=>h(e.target.value),children:[(0,s.jsx)("option",{value:"asc",children:"Сортировать по цене (от дешевых к дорогим)"}),(0,s.jsx)("option",{value:"desc",children:"Сортировать по цене (от дорогих к дешевым)"})]})]}),(0,s.jsx)("div",{className:"flex space-x-2 mb-4",children:["Все","Электроника","Книги","Одежда","Дом","Аксессуары"].map(e=>(0,s.jsx)("button",{className:"p-2 border rounded ".concat(c===e?"bg-red-500 text-white":"text-red-500"),onClick:()=>p(e),children:e},e))}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:j.length>0?j.map(e=>(0,s.jsx)(i,{product:e,onAddToCart:t},e.id)):(0,s.jsx)("p",{children:"Нет доступных товаров"})}),(0,s.jsx)("div",{className:"flex justify-center mt-4",children:Array.from({length:Math.ceil(l.length/10)},(e,t)=>(0,s.jsx)("button",{className:"mx-1 px-3 py-1 border ".concat(g===t+1?"bg-red-500 text-white":"bg-white text-red-500"),onClick:()=>v(t+1),children:t+1},t))})]})},c=e=>{let{cart:t,onClose:r,onRemove:n,onQuantityChange:l,isOpen:a}=e;return(0,s.jsxs)("div",{className:"fixed top-0 ".concat(a?"right-0":"-right-full"," w-full md:w-64 h-full bg-white shadow-lg transform transition-transform duration-300 ease-in-out z-50"),children:[(0,s.jsx)("button",{onClick:r,className:"p-4 text-red-500 font-semibold",children:"Закрыть"}),(0,s.jsx)("h2",{className:"text-xl font-bold mb-4 p-4 text-gray-900",children:"Корзина"}),(0,s.jsx)("ul",{className:"p-4 space-y-4",children:t.map(e=>{var t;return(0,s.jsxs)("li",{className:"flex justify-between items-center mb-2 text-gray-900",children:[(0,s.jsxs)("span",{children:[e.name," (x",null!==(t=e.quantity)&&void 0!==t?t:0,")"]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("button",{className:"mr-2 p-1 bg-yellow-400 text-black rounded hover:bg-yellow-500 transition-colors duration-200",onClick:()=>{var t;return l(e.id,(null!==(t=e.quantity)&&void 0!==t?t:0)-1)},children:"-"}),(0,s.jsx)("button",{className:"p-1 bg-green-500 text-white rounded hover:bg-green-600 transition-colors duration-200",onClick:()=>{var t;return l(e.id,(null!==(t=e.quantity)&&void 0!==t?t:0)+1)},children:"+"}),(0,s.jsx)("button",{className:"ml-2 p-1 bg-red-500 text-white rounded hover:bg-red-600 transition-colors duration-200",onClick:()=>n(e.id),children:"Удалить"})]})]},e.id)})}),(0,s.jsx)("div",{className:"p-4",children:(0,s.jsxs)("strong",{className:"text-gray-900",children:["Итого: ",t.reduce((e,t)=>{var r;return e+t.price*(null!==(r=t.quantity)&&void 0!==r?r:0)},0)," ₸"]})})]})},d=()=>{let[e,t]=(0,a.useState)([]),[r,n]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=localStorage.getItem("cart");if(e)try{t(JSON.parse(e))}catch(e){console.error("Ошибка при разборе данных из localStorage:",e)}},[]),(0,a.useEffect)(()=>{e.length>0?localStorage.setItem("cart",JSON.stringify(e)):localStorage.removeItem("cart")},[e]);let i=r=>{t(e.filter(e=>e.id!==r))};return(0,s.jsxs)("div",{children:[(0,s.jsx)(l(),{children:(0,s.jsx)("title",{children:"Мой интернет-магазин"})}),(0,s.jsxs)("main",{className:"container mx-auto p-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Каталог товаров"}),(0,s.jsxs)("button",{className:"bg-red-500 text-white p-2 rounded mb-4",onClick:()=>n(!r),children:["Корзина (",e.reduce((e,t)=>{var r;return e+(null!==(r=t.quantity)&&void 0!==r?r:0)},0),")"]}),(0,s.jsx)(o,{onAddToCart:r=>{e.find(e=>e.id===r.id)?t(e.map(e=>{var t;return e.id===r.id?{...e,quantity:(null!==(t=e.quantity)&&void 0!==t?t:0)+1}:e})):t([...e,{...r,quantity:1}])}}),(0,s.jsx)(c,{cart:e,onClose:()=>n(!1),onRemove:i,onQuantityChange:(r,s)=>{s<=0?i(r):t(e.map(e=>e.id===r?{...e,quantity:s}:e))},isOpen:r})]})]})}},9008:function(e,t,r){e.exports=r(3867)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);